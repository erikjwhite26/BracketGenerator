@page "/register"
@using BlazorApp.Data
@inject FirebaseAuthService Auth
@inject NavigationManager Nav

<MudPaper Class="login-container" Elevation="10">
    <MudText Typo="Typo.h4" Class="mb-4 login-title">Create Account</MudText>

    @if (!string.IsNullOrEmpty(error))
    {
        <MudAlert Severity="Severity.Error" Dense="true" Class="mb-3">
            @error
        </MudAlert>
    }

    <MudTextField @bind-Value="email"
                  Label="Email"
                  Variant="Variant.Outlined"
                  FullWidth="true"
                  Adornment="Adornment.Start"
                  AdornmentIcon="@Icons.Material.Filled.Email"
                  Class="mb-3 login-input" />

    <MudTextField @bind-Value="password"
                  Label="Password"
                  Variant="Variant.Outlined"
                  FullWidth="true"
                  InputType="InputType.Password"
                  Adornment="Adornment.Start"
                  AdornmentIcon="@Icons.Material.Filled.Lock"
                  Class="mb-4 login-input" />

    <MudButton Variant="Variant.Filled"
               Color="Color.Primary"
               FullWidth="true"
               Class="login-button mb-2"
               OnClick="RegisterUser">
        Register
    </MudButton>

    <MudButton Variant="Variant.Text"
               Color="Color.Primary"
               FullWidth="true"
               Class="register-button"
               Href="/login">
        Already have an account? Login
    </MudButton>
</MudPaper>

@code {
    string email = "";
    string password = "";
    string error = "";

    async Task RegisterUser()
    {
        try
        {
            await Auth.Register(email, password);
            Nav.NavigateTo("./");
        }
        catch (Exception ex)
        {
            error = HelperFunctions.GetFriendlyFirebaseAuthError(ex);
        }
    }
}